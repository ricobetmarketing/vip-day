<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>VIP Mystery Box</title>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@600;800;1000&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#121125;
      --accent:#ff75e2;
      --text:#f6f6ff;
      --muted: rgba(246,246,255,.72);
      --stroke: rgba(255,255,255,.12);
      --panel: rgba(255,255,255,.06);
      --shadow: 0 26px 70px rgba(0,0,0,.55);
      --soft: 0 14px 32px rgba(0,0,0,.40);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; overflow: hidden; }
    body{
      font-family: Inter, sans-serif;
      color:var(--text);
      background: radial-gradient(950px 520px at 50% -10%, rgba(255,117,226,.22), transparent 60%), linear-gradient(180deg, var(--bg), var(--bg));
      display:flex; align-items:center; justify-content:center;
    }

    .wrap{
      width:min(500px, 95%);
      border-radius: 34px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      padding: 30px 20px;
      text-align: center;
      position: relative;
    }

    h1{
      font-family: Orbitron; font-size: 28px; margin: 10px 0;
      background: linear-gradient(180deg, #fff, var(--accent));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    }

    /* THE BOX CONTAINER */
    .box-container {
      position: relative;
      height: 250px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
    }

    .boxImage {
      width: 220px;
      transition: transform 0.1s ease-out;
      filter: drop-shadow(0 0 15px rgba(255,117,226,0.3));
    }

    /* SHAKE ANIMATION */
    .shake {
      animation: boxShake 0.2s ease-in-out;
    }

    @keyframes boxShake {
      0% { transform: rotate(0deg); }
      25% { transform: rotate(5deg) scale(1.05); }
      50% { transform: rotate(-5deg); }
      75% { transform: rotate(3deg); }
      100% { transform: rotate(0deg); }
    }

    /* EXPLODE ANIMATION */
    .explode {
      animation: boxExplode 0.5s forwards;
    }

    @keyframes boxExplode {
      0% { transform: scale(1); opacity: 1; filter: brightness(1); }
      50% { transform: scale(1.5); opacity: 0.8; filter: brightness(5); }
      100% { transform: scale(2); opacity: 0; }
    }

    .progress-bar-wrap {
      width: 100%; height: 8px; background: rgba(255,255,255,0.1);
      border-radius: 10px; margin-top: 20px; overflow: hidden;
    }
    .progress-fill {
      width: 0%; height: 100%; background: var(--accent);
      box-shadow: 0 0 10px var(--accent);
      transition: width 0.3s ease;
    }

    .tap-hint {
      margin-top: 15px; font-weight: 900; font-size: 14px;
      letter-spacing: 2px; color: var(--accent);
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

    /* Modal Styling */
    #overlay{
      display:none; position:fixed; inset:0;
      background: rgba(0,0,0,.85); backdrop-filter: blur(10px);
      z-index: 100; align-items: center; justify-content: center;
    }
    .modal {
      background: white; color: #111; padding: 30px;
      border-radius: 30px; text-align: center; width: 90%; max-width: 400px;
    }
    .bigPrize { font-family: Orbitron; font-size: 24px; color: #d42bb2; margin: 15px 0; font-weight: 900; }
    .codeBox { background: #f0f0f0; border: 2px dashed #ccc; padding: 15px; border-radius: 15px; display: flex; justify-content: space-between; align-items: center; }
    .code { font-family: monospace; font-size: 18px; font-weight: 900; }
    .copyBtn { background: #111; color: white; border: none; padding: 10px 15px; border-radius: 10px; cursor: pointer; font-weight: 800; }
    .closeBtn { margin-top: 20px; width: 100%; padding: 15px; border-radius: 15px; border: none; background: #d42bb2; color: white; font-weight: 900; cursor: pointer; }

  </style>
</head>

<body>

  <div class="wrap">
    <header>
      <h1>VIP MYSTERY BOX</h1>
      <div class="tap-hint" id="hintText">TAP TO UNLOCK</div>
    </header>

    <div class="box-container" onclick="handleTap()">
      <img id="mainBox" class="boxImage" src="https://ricomx.ft-crm.com/media-api/serve/df6b594c-e8bd-402d-b186-efca9501a635_2.png" alt="Box">
    </div>

    <div class="progress-bar-wrap">
      <div class="progress-fill" id="progress"></div>
    </div>
  </div>

  <div id="overlay">
    <div class="modal">
      <h2 style="margin:0; font-size: 16px; opacity: 0.6;">UNLOCKED</h2>
      <div class="bigPrize" id="prizeText">×10 FREE SPINS</div>
      <div class="codeBox">
        <div class="code" id="codeText">VIP-FREE-SPINS</div>
        <button class="copyBtn" onclick="copyCode()">COPY</button>
      </div>
      <button class="closeBtn" onclick="location.reload()">DONE</button>
    </div>
  </div>

  <audio id="tapSound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>
  <audio id="breakSound" src="https://assets.mixkit.co/active_storage/sfx/2857/2857-preview.mp3"></audio>

  <script>
    let taps = 0;
    const requiredTaps = 8; // Change this to require more or fewer clicks
    let isBroken = false;

    const box = document.getElementById("mainBox");
    const progress = document.getElementById("progress");
    const hintText = document.getElementById("hintText");
    const tapSound = document.getElementById("tapSound");
    const breakSound = document.getElementById("breakSound");
    const overlay = document.getElementById("overlay");

    function handleTap() {
      if (isBroken) return;

      taps++;
      
      // Play tap sound
      tapSound.currentTime = 0;
      tapSound.play().catch(()=>{});

      // Visual feedback
      box.classList.remove("shake");
      void box.offsetWidth; // Trigger reflow
      box.classList.add("shake");

      // Update progress
      const percent = (taps / requiredTaps) * 100;
      progress.style.width = percent + "%";

      if (taps >= requiredTaps) {
        breakBox();
      }
    }

    function breakBox() {
      isBroken = true;
      hintText.innerText = "OPENING...";
      
      // Play break sound
      breakSound.play().catch(()=>{});

      // Explosion Effect
      box.classList.add("explode");

      // Final Confetti and Modal
      setTimeout(() => {
        confetti({
          particleCount: 200,
          spread: 90,
          origin: { y: 0.6 },
          colors: ["#ff75e2", "#ffffff", "#00ffaa"]
        });
        
        revealReward();
      }, 500);
    }

    function revealReward() {
      // Logic for random rewards
      const rewards = ["×5 FREE SPINS", "×10 FREE SPINS", "×20 FREE SPINS"];
      const reward = rewards[Math.floor(Math.random() * rewards.length)];
      
      document.getElementById("prizeText").innerText = reward;
      document.getElementById("codeText").innerText = "VIP" + Math.floor(1000 + Math.random() * 9000);
      
      overlay.style.display = "flex";
    }

    function copyCode() {
      const code = document.getElementById("codeText").innerText;
      navigator.clipboard.writeText(code);
      alert("Copied: " + code);
    }
  </script>
</body>
</html>
